#compdef ccd

# easily read all lines of a file into an array
zmodload zsh/mapfile


_ccd() {
    local state ret=1
    typeset -A opt_args

    if (( $CURRENT == 2 )); then
        ## complete directories (only)
        _alternative "dirs::_path_files -/" && ret=0
        ## complete warp points
        local warp_file_dir="$ZSH_CUSTOM_ROOT/plugins/DIRECTORY_AND_FILES/warp/.warp_points"
        local -a warp_points
        for line in "${(f)mapfile[$warp_file_dir]}"; do
            warp_points+=(${line%%=*})
        done
        _alternative "wp:warp point:($warp_points)" && ret=0
    fi

    return ret
}

_ccd "$@"
